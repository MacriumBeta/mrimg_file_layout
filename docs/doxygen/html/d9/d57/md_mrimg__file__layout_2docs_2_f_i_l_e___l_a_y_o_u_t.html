<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Macrium Image File Layout: FILE_LAYOUT</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../ReflectX_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">Macrium Image File Layout
   </div>
   <div id="projectbrief">Source Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d9/d57/md_mrimg__file__layout_2docs_2_f_i_l_e___l_a_y_o_u_t.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">FILE_LAYOUT</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="../../../assets/ReflectX.png" alt="" width="300" class="inline"/> <br  />
Experience data independence with love, from us to you. <img src="../../../assets/Love_Heart_symbol.svg" alt="" style="pointer-events: none;" width="30" class="inline"/></p>
<hr  />
<h2><a class="anchor" id="autotoc_md5"></a>
Macrium Reflect X Image File layout</h2>
<blockquote class="doxtable">
<p>&zwj;[!NOTE] This layout is not valid for Image Files created with Macrium Reflect v8.x or earlier. </p>
</blockquote>
<p>*** </p>
<h2><a class="anchor" id="autotoc_md6"></a>
Overview</h2>
<p>The data layout in an image file is similar to that on a physical disk, including disk format, partitions, and file systems. The following digram shows how a single disk directly maps to a full disk image.</p>
<p><img src="../../../assets/mrimg-layout.png" alt="FILE LAYOUT" class="inline"/></p>
<p>The following diagram shows how multiple disks map to a full disk image. The disks are arranged in sequence, with the metadata for all disks located at the end of the file.</p>
<p><img src="../../../assets/mrimg-layout-2-disks.png" alt="FILE LAYOUT" class="inline"/></p>
<p>Incremental image files contain only data blocks that are different from the prevous image in the backup set. Differential image files contain only data blocks that are different from the full image in the backup set. </p><blockquote class="doxtable">
<p>&zwj;[!NOTE] Consolidated images may contain data blocks in a random order prior to the metadata at the end of the file. </p>
</blockquote>
<hr  />
<h2><a class="anchor" id="autotoc_md7"></a>
Special considerations for FAT File Systems</h2>
<p>FAT file systems, including FAT32/16/12, are managed differently within image files because of Reserved Sectors preceding the file system data. These reserved sectors comprise the Boot Sector, followed by up to 2 copies of the File Allocation Table (FAT).</p>
<p>In instances where non-standard FAT32 file systems exceed the Windows maximum of 32GB, the number of reserved sectors can be substantial. To address this, the reserved sectors data is segmented into 4MB blocks and indexed in the <code>Reserved Sectors Index</code>, which is positioned before the primary block index in the metadata. A <code>Reserved Sectors Index</code>exists for every FAT file system backed up.</p>
<blockquote class="doxtable">
<p>&zwj;[!NOTE] As with file system Data blocks, Reserved sector blocks may be compressed and/or encrypted depending on the backup settings. </p>
</blockquote>
<p><img src="../../../assets/mrimg-layout-FAT32.png" alt="FILE LAYOUT" class="inline"/></p>
<blockquote class="doxtable">
<p>&zwj;[!NOTE] The example above also describes the exact image file format for all Macrium <code>File and Folder backups</code>. </p>
</blockquote>
<hr  />
 <h2><a class="anchor" id="autotoc_md8"></a>
Let's dive deeper by looking at the metadata elements that make up the image file:</h2>
<p><img src="../../../assets/mrimg-schematic.png" alt="FILE LAYOUT" class="inline"/> </p><hr  />
 <h2><a class="anchor" id="autotoc_md9"></a>
File Footer</h2>
<p>At the end of each image file, a 20-byte sequence verifies the file as a Macrium Image through a 12-byte magic identifier and provides the offset to the initial Metadata block to enable the continued reading of the file.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span>FileFooter</div>
<div class="line">{</div>
<div class="line">    uint64_t firstmetadatablockheader;</div>
<div class="line">    uint8_t magicbytes[12]; <span class="comment">// MACRIUM_FILE</span></div>
<div class="line">};</div>
</div><!-- fragment --> <hr  />
 <h2><a class="anchor" id="autotoc_md10"></a>
Metadata Block</h2>
<p>Metadata blocks are structured to store binary data. Blocks are organized lists, and each block is preceded by a header, which provides the data's length, its encryption and compression statuses, the MD5 hash of the data, and whether this is the last block in the list.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../db/d8e/struct_header_flags.html">HeaderFlags</a></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="../../db/d8e/struct_header_flags.html#ae9f3930fab82a8e425ce45c3d4b6fdb0">LastBlock</a> : 1;   </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="../../db/d8e/struct_header_flags.html#af3118c4dfb29759e1ea701fe8fc8fbc8">Compression</a> : 1; </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="../../db/d8e/struct_header_flags.html#ab892a9d6e9b1255cc44b905dc1111564">Encryption</a> : 1;  </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="../../db/d8e/struct_header_flags.html#a3125102af83a54a25ae47e5e652e7987">Unused</a> : 5;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../dc/da1/struct_metadata_block_header.html">MetadataBlockHeader</a></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span>  <a class="code hl_variable" href="../../dc/da1/struct_metadata_block_header.html#a72e39badcad3c5db5fd002aab588cb5e">BlockName</a>[8];   </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code hl_variable" href="../../dc/da1/struct_metadata_block_header.html#a3b09f927547130bf773f72b402915a7f">BlockLength</a>; </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>  <a class="code hl_variable" href="../../dc/da1/struct_metadata_block_header.html#a2690f665cbead826a5a06cfba2d4ac8e">Hash</a>[16]; </div>
<div class="line">    <a class="code hl_struct" href="../../db/d8e/struct_header_flags.html">HeaderFlags</a> <a class="code hl_variable" href="../../dc/da1/struct_metadata_block_header.html#a65be67dd89ddaf9fc2db321eda1300af">Flags</a>;</div>
<div class="line">    <span class="keywordtype">char</span> <a class="code hl_variable" href="../../dc/da1/struct_metadata_block_header.html#a3633b8b8ab5107ba489eea45faf12dbf">Padding</a>[3];</div>
<div class="line">};</div>
<div class="ttc" id="astruct_header_flags_html"><div class="ttname"><a href="../../db/d8e/struct_header_flags.html">HeaderFlags</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00035">metadataheader.h:36</a></div></div>
<div class="ttc" id="astruct_header_flags_html_a3125102af83a54a25ae47e5e652e7987"><div class="ttname"><a href="../../db/d8e/struct_header_flags.html#a3125102af83a54a25ae47e5e652e7987">HeaderFlags::Unused</a></div><div class="ttdeci">unsigned char Unused</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00040">metadataheader.h:40</a></div></div>
<div class="ttc" id="astruct_header_flags_html_ab892a9d6e9b1255cc44b905dc1111564"><div class="ttname"><a href="../../db/d8e/struct_header_flags.html#ab892a9d6e9b1255cc44b905dc1111564">HeaderFlags::Encryption</a></div><div class="ttdeci">unsigned char Encryption</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00039">metadataheader.h:39</a></div></div>
<div class="ttc" id="astruct_header_flags_html_ae9f3930fab82a8e425ce45c3d4b6fdb0"><div class="ttname"><a href="../../db/d8e/struct_header_flags.html#ae9f3930fab82a8e425ce45c3d4b6fdb0">HeaderFlags::LastBlock</a></div><div class="ttdeci">unsigned char LastBlock</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00037">metadataheader.h:37</a></div></div>
<div class="ttc" id="astruct_header_flags_html_af3118c4dfb29759e1ea701fe8fc8fbc8"><div class="ttname"><a href="../../db/d8e/struct_header_flags.html#af3118c4dfb29759e1ea701fe8fc8fbc8">HeaderFlags::Compression</a></div><div class="ttdeci">unsigned char Compression</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00038">metadataheader.h:38</a></div></div>
<div class="ttc" id="astruct_metadata_block_header_html"><div class="ttname"><a href="../../dc/da1/struct_metadata_block_header.html">MetadataBlockHeader</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00046">metadataheader.h:47</a></div></div>
<div class="ttc" id="astruct_metadata_block_header_html_a2690f665cbead826a5a06cfba2d4ac8e"><div class="ttname"><a href="../../dc/da1/struct_metadata_block_header.html#a2690f665cbead826a5a06cfba2d4ac8e">MetadataBlockHeader::Hash</a></div><div class="ttdeci">unsigned char Hash[16]</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00050">metadataheader.h:50</a></div></div>
<div class="ttc" id="astruct_metadata_block_header_html_a3633b8b8ab5107ba489eea45faf12dbf"><div class="ttname"><a href="../../dc/da1/struct_metadata_block_header.html#a3633b8b8ab5107ba489eea45faf12dbf">MetadataBlockHeader::Padding</a></div><div class="ttdeci">char Padding[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00052">metadataheader.h:52</a></div></div>
<div class="ttc" id="astruct_metadata_block_header_html_a3b09f927547130bf773f72b402915a7f"><div class="ttname"><a href="../../dc/da1/struct_metadata_block_header.html#a3b09f927547130bf773f72b402915a7f">MetadataBlockHeader::BlockLength</a></div><div class="ttdeci">unsigned long BlockLength</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00049">metadataheader.h:49</a></div></div>
<div class="ttc" id="astruct_metadata_block_header_html_a65be67dd89ddaf9fc2db321eda1300af"><div class="ttname"><a href="../../dc/da1/struct_metadata_block_header.html#a65be67dd89ddaf9fc2db321eda1300af">MetadataBlockHeader::Flags</a></div><div class="ttdeci">HeaderFlags Flags</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00051">metadataheader.h:51</a></div></div>
<div class="ttc" id="astruct_metadata_block_header_html_a72e39badcad3c5db5fd002aab588cb5e"><div class="ttname"><a href="../../dc/da1/struct_metadata_block_header.html#a72e39badcad3c5db5fd002aab588cb5e">MetadataBlockHeader::BlockName</a></div><div class="ttdeci">char BlockName[8]</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00048">metadataheader.h:48</a></div></div>
</div><!-- fragment --><p> BlockName may be set to the following values. </p><div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="comment">// JSON data that describes the image file and supplementary backup information. </span></div>
<div class="line"><span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_variable" href="../../d9/dd3/metadataheader_8h.html#a122a277744dc96bb43da2924f02ad988">JSON_HEADER</a>   = <span class="stringliteral">&quot;$JSON   &quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// disk data</span></div>
<div class="line"><span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_variable" href="../../d9/dd3/metadataheader_8h.html#a00e6e6c6314d1b1bfa9d2ef197fed95b">TRACK_0</a>       = <span class="stringliteral">&quot;$TRACK0 &quot;</span>;</div>
<div class="line"><span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_variable" href="../../d9/dd3/metadataheader_8h.html#af82ee4852ddb8e2c6b07e5afee2cd160">EXT_PAR_TABLE</a> = <span class="stringliteral">&quot;$EPT    &quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// partition data</span></div>
<div class="line"><span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code hl_variable" href="../../d9/dd3/metadataheader_8h.html#a0e2b502c08e80955f7473e8953434958">BITMAP_HEADER</a> = <span class="stringliteral">&quot;$BITMAP &quot;</span>;</div>
<div class="ttc" id="ametadataheader_8h_html_a00e6e6c6314d1b1bfa9d2ef197fed95b"><div class="ttname"><a href="../../d9/dd3/metadataheader_8h.html#a00e6e6c6314d1b1bfa9d2ef197fed95b">TRACK_0</a></div><div class="ttdeci">const char *const TRACK_0</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00026">metadataheader.h:26</a></div></div>
<div class="ttc" id="ametadataheader_8h_html_a0e2b502c08e80955f7473e8953434958"><div class="ttname"><a href="../../d9/dd3/metadataheader_8h.html#a0e2b502c08e80955f7473e8953434958">BITMAP_HEADER</a></div><div class="ttdeci">const char *const BITMAP_HEADER</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00022">metadataheader.h:22</a></div></div>
<div class="ttc" id="ametadataheader_8h_html_a122a277744dc96bb43da2924f02ad988"><div class="ttname"><a href="../../d9/dd3/metadataheader_8h.html#a122a277744dc96bb43da2924f02ad988">JSON_HEADER</a></div><div class="ttdeci">const char *const JSON_HEADER</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00021">metadataheader.h:21</a></div></div>
<div class="ttc" id="ametadataheader_8h_html_af82ee4852ddb8e2c6b07e5afee2cd160"><div class="ttname"><a href="../../d9/dd3/metadataheader_8h.html#af82ee4852ddb8e2c6b07e5afee2cd160">EXT_PAR_TABLE</a></div><div class="ttdeci">const char *const EXT_PAR_TABLE</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd3/metadataheader_8h_source.html#l00027">metadataheader.h:27</a></div></div>
</div><!-- fragment --><p> Not all BlockName headers are included in this document. <br  />
<br  />
 <b>Reading the block list</b> <br  />
 <code>If LastBlock == 0, then the next block begins at the file offset for this block + sizeof(MetadataBlockHeader) + blocklength</code></p>
<hr  />
<h2><a class="anchor" id="autotoc_md11"></a>
Data Block Index Element</h2>
<p>Block index elements specify both the position and the size of a Data Block within the file, where Data Blocks contain the actual data from the imaged file system. These elements are organized in a vector list, and represent the full extent of the imaged file system. This layout enables easy location and retrieval of the stored data.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span>DataBlockIndexElement</div>
<div class="line">{</div>
<div class="line">    uint64_t fileposition;</div>
<div class="line">    uint8_t hash[16];</div>
<div class="line">    uint32_t blocklength;</div>
<div class="line">    uint32_t filenumber;</div>
<div class="line">}</div>
</div><!-- fragment --> <hr  />
 <h2><a class="anchor" id="autotoc_md12"></a>
Data Block</h2>
<p>A Data Block is the raw data of the imaged file system. Each block is a fixed length per partition, and can be compressed and/or encrypted based on the backup settings. The location and size of each block are shown in a related Data Block Index Element.<br  />
</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">uint8_t blockdata[blocklength];</div>
</div><!-- fragment --> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Information   </th><th class="markdownTableHeadLeft">Link    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Encryption Implementation   </td><td class="markdownTableBodyLeft"><a class="el" href="../../d1/d49/md_mrimg__file__layout_2docs_2_e_n_c_r_y_p_t_i_o_n.html">See here</a>   </td></tr>
</table>
<hr  />
 <h3><a class="anchor" id="autotoc_md13"></a>
ROOT - $JSON</h3>
<p>This mandatory metadata block, at the root level of the file, is the source of navigational and supplementary information necessary for understanding and accessing the contents of the backup. This JSON text also provides auxiliary data including details about the backup environment and settings.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Information   </th><th class="markdownTableHeadLeft">Link    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">JSON Schema details   </td><td class="markdownTableBodyLeft"><a href="../../../schema">See here</a> <br  />
    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Example Image file JSON   </td><td class="markdownTableBodyLeft"><a href="../../../schema/examples/image_1.json">See here</a> <br  />
    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Example File and Folder backup JSON   </td><td class="markdownTableBodyLeft"><a href="../../../schema/examples/file_and_folder_1.json">See here</a> <br  />
   </td></tr>
</table>
<hr  />
 <h3><a class="anchor" id="autotoc_md14"></a>
DISK - $TRACK0</h3>
<p>This mandatory metadata block contains the initial 1,048,576 bytes (1MB) of the disk, including the critical boot and partition data structures. For Master Boot Record (MBR) disks, it includes the MBR itself along with the partition table. For disks GUID <a class="el" href="../../d6/d1d/struct_partition.html">Partition</a> Table (GPT) disks, it provides the GPT header and partition table. Beyond the Master Boot Record (MBR) and GUID <a class="el" href="../../d6/d1d/struct_partition.html">Partition</a> Table (GPT) structures, the extra data may include additional disk boot code, including but not limited to, Linux's GRUB bootloader.</p>
<p>MBR formatted disks at LBA 0 (Sector 1): </p><div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d6/d1d/struct_partition.html">Partition</a> {</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#aafdb0ee80b0d13ec79202ada05e37c93">status</a>;</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a36182e2ee744f7abd7a49c15535c8a10">startHead</a>;</div>
<div class="line">    uint16_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a036c0f1086a69e25f54699b568fb68ba">startSectorCylinder</a>;</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a1bc0f183b14d52f66b840157a77ab810">type</a>;</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a67c18d4348609afb2afc0e616959ef12">endHead</a>;</div>
<div class="line">    uint16_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a396ceed540efa5721dd524fd364dfe7b">endSectorCylinder</a>;</div>
<div class="line">    uint32_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a939ab648ee2665ecff6fa9249c2a8b8c">bootSectorOffset</a>;  </div>
<div class="line">    uint32_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a379e0546112c2e06135be1ab2ae421ca">numberOfSectors</a>;</div>
<div class="line">} ;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d88/struct_boot_record.html">BootRecord</a> {</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#ac30ca134f478decd2f12332d4d3d3f90">bootCode</a>[442];</div>
<div class="line">    uint32_t <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#a9c2805321a2cfe685041d84326cbd2e8">signature</a>;</div>
<div class="line">    <a class="code hl_struct" href="../../d6/d1d/struct_partition.html">Partition</a> <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#ae01e3226edbbc7f60c4e5e925670a845">partitionEntries</a>[4];</div>
<div class="line">    uint16_t <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#a5558034b0043ffa144ef6c6fbfc18150">idCode</a>;</div>
<div class="line">};</div>
<div class="ttc" id="astruct_boot_record_html"><div class="ttname"><a href="../../d1/d88/struct_boot_record.html">BootRecord</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00021">disk_structs.h:21</a></div></div>
<div class="ttc" id="astruct_boot_record_html_a5558034b0043ffa144ef6c6fbfc18150"><div class="ttname"><a href="../../d1/d88/struct_boot_record.html#a5558034b0043ffa144ef6c6fbfc18150">BootRecord::idCode</a></div><div class="ttdeci">uint16_t idCode</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00025">disk_structs.h:25</a></div></div>
<div class="ttc" id="astruct_boot_record_html_a9c2805321a2cfe685041d84326cbd2e8"><div class="ttname"><a href="../../d1/d88/struct_boot_record.html#a9c2805321a2cfe685041d84326cbd2e8">BootRecord::signature</a></div><div class="ttdeci">uint32_t signature</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00023">disk_structs.h:23</a></div></div>
<div class="ttc" id="astruct_boot_record_html_ac30ca134f478decd2f12332d4d3d3f90"><div class="ttname"><a href="../../d1/d88/struct_boot_record.html#ac30ca134f478decd2f12332d4d3d3f90">BootRecord::bootCode</a></div><div class="ttdeci">uint8_t bootCode[442]</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00022">disk_structs.h:22</a></div></div>
<div class="ttc" id="astruct_boot_record_html_ae01e3226edbbc7f60c4e5e925670a845"><div class="ttname"><a href="../../d1/d88/struct_boot_record.html#ae01e3226edbbc7f60c4e5e925670a845">BootRecord::partitionEntries</a></div><div class="ttdeci">Partition partitionEntries[4]</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00024">disk_structs.h:24</a></div></div>
<div class="ttc" id="astruct_partition_html"><div class="ttname"><a href="../../d6/d1d/struct_partition.html">Partition</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00009">disk_structs.h:9</a></div></div>
<div class="ttc" id="astruct_partition_html_a036c0f1086a69e25f54699b568fb68ba"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a036c0f1086a69e25f54699b568fb68ba">Partition::startSectorCylinder</a></div><div class="ttdeci">uint16_t startSectorCylinder</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00012">disk_structs.h:12</a></div></div>
<div class="ttc" id="astruct_partition_html_a1bc0f183b14d52f66b840157a77ab810"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a1bc0f183b14d52f66b840157a77ab810">Partition::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00013">disk_structs.h:13</a></div></div>
<div class="ttc" id="astruct_partition_html_a36182e2ee744f7abd7a49c15535c8a10"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a36182e2ee744f7abd7a49c15535c8a10">Partition::startHead</a></div><div class="ttdeci">uint8_t startHead</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00011">disk_structs.h:11</a></div></div>
<div class="ttc" id="astruct_partition_html_a379e0546112c2e06135be1ab2ae421ca"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a379e0546112c2e06135be1ab2ae421ca">Partition::numberOfSectors</a></div><div class="ttdeci">uint32_t numberOfSectors</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00017">disk_structs.h:17</a></div></div>
<div class="ttc" id="astruct_partition_html_a396ceed540efa5721dd524fd364dfe7b"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a396ceed540efa5721dd524fd364dfe7b">Partition::endSectorCylinder</a></div><div class="ttdeci">uint16_t endSectorCylinder</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00015">disk_structs.h:15</a></div></div>
<div class="ttc" id="astruct_partition_html_a67c18d4348609afb2afc0e616959ef12"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a67c18d4348609afb2afc0e616959ef12">Partition::endHead</a></div><div class="ttdeci">uint8_t endHead</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00014">disk_structs.h:14</a></div></div>
<div class="ttc" id="astruct_partition_html_a939ab648ee2665ecff6fa9249c2a8b8c"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#a939ab648ee2665ecff6fa9249c2a8b8c">Partition::bootSectorOffset</a></div><div class="ttdeci">uint32_t bootSectorOffset</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00016">disk_structs.h:16</a></div></div>
<div class="ttc" id="astruct_partition_html_aafdb0ee80b0d13ec79202ada05e37c93"><div class="ttname"><a href="../../d6/d1d/struct_partition.html#aafdb0ee80b0d13ec79202ada05e37c93">Partition::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00010">disk_structs.h:10</a></div></div>
</div><!-- fragment --><p> GPT formatted disks, starting at offset LBA 1 (Sector 2) in $TRACK0: </p><div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span>gptheader {</div>
<div class="line">    uint64_t signature;</div>
<div class="line">    uint32_t revision;</div>
<div class="line">    uint32_t header_size;</div>
<div class="line">    uint32_t header_crc32;</div>
<div class="line">    uint32_t reserved1;</div>
<div class="line">    uint64_t my_lba;</div>
<div class="line">    uint64_t alternate_lba;</div>
<div class="line">    uint64_t first_usable_lba;</div>
<div class="line">    uint64_t last_usable_lba;</div>
<div class="line">    <a class="code hl_struct" href="../../d7/de1/struct__efi__guid__t.html">efi_guid_t</a> disk_guid;</div>
<div class="line">    uint64_t partition_entry_lba;</div>
<div class="line">    uint32_t num_partition_entries;</div>
<div class="line">    uint32_t sizeof_partition_entry;</div>
<div class="line">    uint32_t partition_entry_array_crc32;</div>
<div class="line">    uint8_t  reserved2[420];</div>
<div class="line">};</div>
<div class="ttc" id="astruct__efi__guid__t_html"><div class="ttname"><a href="../../d7/de1/struct__efi__guid__t.html">_efi_guid_t</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00061">disk_structs.h:61</a></div></div>
</div><!-- fragment --><p> The GPT partition table is typically at LBA 2 (sector 3), but can be found by reading the partition_entry_lba field in the gptheader struct. </p><div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d9/d3f/struct__gpt__entry__attributes.html">gpt_entry_attributes</a></div>
<div class="line">{</div>
<div class="line">    uint64_t required_to_function:1;</div>
<div class="line">    uint64_t reserved:47;</div>
<div class="line">    uint64_t type_guid_specific:16;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>gpt_table_entry {</div>
<div class="line">    <a class="code hl_struct" href="../../d7/de1/struct__efi__guid__t.html">efi_guid_t</a> partition_type_guid;</div>
<div class="line">    <a class="code hl_struct" href="../../d7/de1/struct__efi__guid__t.html">efi_guid_t</a> unique_partition_guid;</div>
<div class="line">    uint64_t starting_lba;</div>
<div class="line">    uint64_t ending_lba;</div>
<div class="line">    <a class="code hl_struct" href="../../d9/d3f/struct__gpt__entry__attributes.html">gpt_entry_attributes</a> attributes;</div>
<div class="line">    uint16_t partition_name[36];</div>
<div class="line">};</div>
<div class="ttc" id="astruct__gpt__entry__attributes_html"><div class="ttname"><a href="../../d9/d3f/struct__gpt__entry__attributes.html">_gpt_entry_attributes</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d4b/disk__structs_8h_source.html#l00104">disk_structs.h:104</a></div></div>
</div><!-- fragment --><p> A Windows GPT formatted disk contains an array of 128 gpt_table_entry structures.</p>
<p>Note: $TRACK0 may be the only metadata block at disk level. </p><hr  />
 <h3><a class="anchor" id="autotoc_md15"></a>
DISK - $EPT</h3>
<p>This optional metadata block contains an array of Extended <a class="el" href="../../d6/d1d/struct_partition.html">Partition</a> Tables (Extended Boot Records), preceded by a uint32_t count of elements. </p><blockquote class="doxtable">
<p>&zwj;[!NOTE] $EPT data is only populated for MBR formatted disks with an extended partition table. </p>
</blockquote>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d6/d1d/struct_partition.html">Partition</a> {</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#aafdb0ee80b0d13ec79202ada05e37c93">status</a>;</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a36182e2ee744f7abd7a49c15535c8a10">startHead</a>;</div>
<div class="line">    uint16_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a036c0f1086a69e25f54699b568fb68ba">startSectorCylinder</a>;</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a1bc0f183b14d52f66b840157a77ab810">type</a>;</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a67c18d4348609afb2afc0e616959ef12">endHead</a>;</div>
<div class="line">    uint16_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a396ceed540efa5721dd524fd364dfe7b">endSectorCylinder</a>;</div>
<div class="line">    uint32_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a939ab648ee2665ecff6fa9249c2a8b8c">bootSectorOffset</a>;  </div>
<div class="line">    uint32_t <a class="code hl_variable" href="../../d6/d1d/struct_partition.html#a379e0546112c2e06135be1ab2ae421ca">numberOfSectors</a>;</div>
<div class="line">} <a class="code hl_typedef" href="../../da/d4b/disk__structs_8h.html#a96dcdea8b42e47d4600bd9ace954a11d">Partition</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d88/struct_boot_record.html">BootRecord</a> {</div>
<div class="line">    uint8_t  <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#ac30ca134f478decd2f12332d4d3d3f90">bootCode</a>[442];</div>
<div class="line">    uint32_t <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#a9c2805321a2cfe685041d84326cbd2e8">signature</a>;</div>
<div class="line">    <a class="code hl_struct" href="../../d6/d1d/struct_partition.html">Partition</a> <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#ae01e3226edbbc7f60c4e5e925670a845">partitionEntries</a>[4];</div>
<div class="line">    uint16_t <a class="code hl_variable" href="../../d1/d88/struct_boot_record.html#a5558034b0043ffa144ef6c6fbfc18150">idCode</a>;</div>
<div class="line">} <a class="code hl_typedef" href="../../da/d4b/disk__structs_8h.html#a29078f1dca5bf2015af873762c0ba5cb">BootRecord</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>ExtendedPartitionTable</div>
<div class="line">{</div>
<div class="line">    PartitionSector partitionsector;</div>
<div class="line">    uint64_t  diskbyteoffset;</div>
<div class="line">    uint16_t  partitionnumber;</div>
<div class="line">};</div>
<div class="ttc" id="adisk__structs_8h_html_a29078f1dca5bf2015af873762c0ba5cb"><div class="ttname"><a href="../../da/d4b/disk__structs_8h.html#a29078f1dca5bf2015af873762c0ba5cb">BootRecord</a></div><div class="ttdeci">struct BootRecord BootRecord</div></div>
<div class="ttc" id="adisk__structs_8h_html_a96dcdea8b42e47d4600bd9ace954a11d"><div class="ttname"><a href="../../da/d4b/disk__structs_8h.html#a96dcdea8b42e47d4600bd9ace954a11d">Partition</a></div><div class="ttdeci">struct Partition Partition</div></div>
</div><!-- fragment --> <hr  />
 <h3><a class="anchor" id="autotoc_md16"></a>
PARTITION - $BITMAP</h3>
<p>This optional metadata block contains the $BITMAP metadata related to the file system. Currently, it is only populated for exFAT and ReFS file systems. Although it provides valuable insights into the file system structure, this block is not mandatory for the restoration of the image file. </p><hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
